<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>慢速粒子彈開動畫</title>
  <style>
    body { margin: 0; background: black; overflow: hidden; cursor: crosshair; }
    canvas { display: block; }
  </style>
</head>
<body>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let w = canvas.width = window.innerWidth;
let h = canvas.height = window.innerHeight;

window.addEventListener('resize', () => {
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
});

let mouseX = w / 2;
let mouseY = h / 2;

window.addEventListener('mousemove', e => {
  mouseX = e.clientX;
  mouseY = e.clientY;
});

const stars = [];

function createStar() {
  const angle = Math.random() * Math.PI * 2;
  const vx = Math.cos(angle) * 0.0;   // 慢速
  const vy = Math.sin(angle) * 0

  stars.push({
    x: mouseX,
    y: mouseY,
    vx,
    vy,
    ax: vx * 0.000,  // 緩慢加速
    ay: vy * 0.000,
    size: Math.random() * 2 + 1,
    color: `hsl(${Math.random() * 180}, 80%, 70%)`
  });
}

function draw() {
  ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
  ctx.fillRect(0, 0, w, h);

  for (let s of stars) {
    s.vx += s.ax;
    s.vy += s.ay;
    s.x += s.vx;
    s.y += s.vy;
    ctx.beginPath();
    ctx.fillStyle = s.color;
    ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
    ctx.fill();
  }

  // ⭐ 粒子間彈開（碰撞排斥）
  const minDist = 14;
  const repelStrength = 0.05;

  for (let i = 0; i < stars.length; i++) {
    for (let j = i + 1; j < stars.length; j++) {
      const a = stars[i];
      const b = stars[j];
      const dx = b.x - a.x;
      const dy = b.y - a.y;
      const dist = Math.hypot(dx, dy);

      if (dist < minDist && dist > 0.1) {
        const force = (minDist - dist) * repelStrength;
        const nx = dx / dist;
        const ny = dy / dist;
        a.vx -= nx * force;
        a.vy -= ny * force;
        b.vx += nx * force;
        b.vy += ny * force;
      }
    }
  }

  // 每幀新增粒子
  for (let i = 0; i < 2; i++) createStar();
  while (stars.length > 1000) stars.shift();

  requestAnimationFrame(draw);
}

draw();
</script>
</body>
</html>
